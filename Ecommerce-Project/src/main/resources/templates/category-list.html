<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin-template}">
<head>
<title>Categories</title>

<style>
tr.clickable-row td {
	cursor: pointer;
}

tr.clickable-row:hover {
	color: #82B1FF;
}
</style>
</head>

<body>
	<div class="container-fluid" layout:fragment="page-content">

		<!-- Page Heading -->
		<h1 class="h3 mb-2 text-gray-800">Categories</h1>
		<p class="mb-4">
			DataTables is a third party plugin that is used to generate the demo
			table below. For more information about DataTables, please visit the
			<a target="_blank" href="https://datatables.net">official
				DataTables documentation</a>
			.
		</p>

		<!-- DataTales Example -->
		<div class="card shadow mb-4">
			<div class="card-header py-3">
				<div class="row">
					<div class="col-6">
						<h6 class="m-0 font-weight-bold text-dark">Category
							Information</h6>
					</div>

					<div class="col-6">
						<button class="btn btn-dark py-0 float-right"
							data-target="#addModal" data-toggle="modal">Add New
							Category</button>
					</div>
				</div>

			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table class="table table-bordered" id="dataTable" width="100%"
						cellspacing="0">
						<thead>
							<tr>
								<th>Code</th>
								<th>Name</th>
								<th>Added Date</th>
								<th>Last Updated</th>
							</tr>
						</thead>
						<tbody>
							<th:block th:each="cate: ${categories}">
								<tr class='clickable-row' data-toggle="modal"
									th:attr="data-id=${cate.id}, data-name=${cate.name}, data-created_at=${cate.created_at}"
									data-target="#editModal">
									<td th:text="${cate.id!= null} ? ${cate.id} : '-'"></td>
									<td th:text="${cate.name != null} ? ${cate.name} : '-'"></td>
									<td
										th:text="${cate.created_at != null} ? ${cate.created_at } : '-'"></td>
									<td
										th:text="${cate.updated_at != null} ? ${cate.updated_at } : '-'"></td>
								</tr>
							</th:block>
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<!-- Add Modal -->
		<div class="modal fade" id="addModal" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalCenterTitle">Add
							Category</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form th:action=@{/admin/category/save} method="POST"
						th:object=${category}>
						<div class="modal-body">

							<input type="hidden" th:field="*{id}" />
							<div>
								<label for="" class="form-label">Name</label>
								<input type="text" class="form-control" th:field="*{name}"
									placeholder="category name" required />
							</div>

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary"
								data-dismiss="modal">Cancel</button>
							<button type="submit" class="btn btn-success">Save</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- Edit Modal -->
		<div class="modal fade" id="editModal" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalCenterTitle">Edit
							Category</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form th:action=@{/admin/category/save} method="POST"
						th:object=${category}>
						<div class="modal-body">

							<input type="hidden" th:field="*{id}" id="cateId" value="" />
							<input type="hidden" th:field="*{created_at}" id="cate-created-at" value="" />
							<div>
								<label for="" class="form-label">Name</label>
								<input type="text" class="form-control" th:field="*{name}"
									placeholder="category name" id="cateName" required />
							</div>

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary"
								data-dismiss="modal">Cancel</button>
							<button type="button" class="btn btn-danger" data-toggle="modal"
								data-target="#deleteModal">Delete</button>
							<button type="submit" class="btn btn-success">Save
								changes</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!--  Delete Modal  -->
		<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Are you sure
							you want to delete this category?</h5>
						<button class="close" type="button" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">Ã—</span>
						</button>
					</div>
					<div class="modal-body">Once deleted, it cannot be restored.</div>
					<div class="modal-footer">
						<button class="btn btn-secondary" type="button"
							data-dismiss="modal">Cancel</button>
						<a class="btn btn-danger" id="deleteBtn" href="">Delete</a>
					</div>
				</div>
			</div>
		</div>
	</div>

	<th:block layout:fragment="js">
		<script th:src="@{/app/js/searchTable.js}"></script>
		<script>
			$(document).ready(function() {
				$('.clickable-row').click(function() {
					$('#cateId').val($(this).data('id'))
					$('#cateName').val($(this).data('name'))
					$('#cate-created-at').val($(this).data('created_at'))
					var link = '/admin/category/delete/' + $(this).data('id')
					$('#deleteBtn').attr('href', link)
				})
			})
		</script>
	</th:block>
</body>
</html>